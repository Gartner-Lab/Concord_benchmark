cor(t(mat1),t(mat2))
dim(mat1)
dim(mat2)
library(VisCello)
cello()
library(VisCello)
cello("./save/pbmc3k_Oct06/cello_pbmc3k_pbmc3k_Oct06/")
head(exprs(eset))
cello("./save/pbmc3k_Oct06/cello_pbmc3k_pbmc3k_Oct06/")
library(VisCello)
cello("../data/intestine_dev/cello_concord_Huycke_intestine_concord_Huycke_intestine_Oct14")
cello("./data/intestine_dev/cello_concord_Huycke_intestine_concord_Huycke_intestine_Oct14")
install.packages('IRkernel')
IRkernel::installspec(user = FALSE)
library(VisCello)
cello("./data/Shichen_immune/cello_concord_Shichen_immune_Nov21-1457/")
cello("./data/Shichen_immune/cello_concord_Shichen_immune_Nov21-1457/")
cello("./data/Shichen_immune/cello_concord_Shichen_immune_Nov21-1457/")
library(VisCello)
cello("data/intestine_dev/cello_benchmark_Huycke_Jan06-2307/")
cello("data/intestine_dev/cello_benchmark_Huycke_Jan07-1351/")
cello("data/intestine_dev/cello_benchmark_Huycke_Jan07-1351/")
cello("data/intestine_dev/cello_benchmark_Huycke_Jan07-1351/")
cello("data/intestine_dev/cello_benchmark_Huycke_Jan07-1351/")
install.packages('Seurat')
library(Seurat)
library(VisCello)
cello("data/intestine_dev/cello_benchmark_Huycke_Jan08-1324")
cello("data/intestine_dev/cello_benchmark_Huycke_Jan08-1324")
cello("data/intestine_dev/cello_benchmark_Huycke_Jan08-1324")
cello("data/intestine_dev/cello_benchmark_Huycke_Jan08-1324")
cello("data/intestine_dev/cello_benchmark_Huycke_Jan08-1324")
cello("data/intestine_dev/cello_benchmark_Huycke_Jan08-1324")
cello("data/intestine_dev/cello_benchmark_Huycke_cc__Jan09-18464")
cello("data/intestine_dev/cello_benchmark_Huycke_cc__Jan09-18464")
cello("data/intestine_dev/cello_benchmark_Huycke_Jan07-1351/")
cello("data/intestine_dev/cello_benchmark_Huycke_cc__Jan09-18464")
cello("data/intestine_dev/cello_benchmark_Huycke_cc__Jan09-18464")
cello("data/intestine_dev/cello_benchmark_Huycke_cc__Jan09-1846/")
cello("data/intestine_dev/cello_benchmark_Huycke_cc__Jan09-1846/")
cello("data/intestine_dev/cello_benchmark_Huycke_cc__Jan09-1846/")
head(clist$`All cells`@proj$PCA_cc)
head(clist$`All cells`@proj$YMAP_cc)
head(clist$`All cells`@proj$UMAP_cc)
colnames(clist$`All cells`@proj$PCA_cc)
colnames(clist$`All cells`@proj$PCA_cc) = gsub('PCA', 'P_C_A', colnames(clist$`All cells`@proj$PCA_cc))
colnames(clist$`All cells`@proj$PCA_cc)
saveRDS(clist, "data/intestine_dev/cello_benchmark_Huycke_cc__Jan09-1846/clist.rds")
cello("data/intestine_dev/cello_benchmark_Huycke_cc__Jan09-1846/")
clist$`All cells`@proj$P_CA_cc = clist$`All cells`@proj$PCA_cc
saveRDS(clist, "data/intestine_dev/cello_benchmark_Huycke_cc__Jan09-1846/clist.rds")
cello("data/intestine_dev/cello_benchmark_Huycke_cc__Jan09-1846/")
cello("data/intestine_dev/cello_benchmark_Huycke_cc__Jan09-1846/")
install.packages('IRkernel')
IRkernel::installspec()
IRkernel::installspec()
Sys.setenv(PATH = paste("/opt/anaconda3/envs/concord/bin", Sys.getenv("PATH"), sep = ":"))
IRkernel::installspec()
install.packages('anndata')
cello("data/intestine_dev/cello_benchmark_Huycke_cc__Jan09-1846/")
library(VisCello)
cello("data/intestine_dev/cello_benchmark_Huycke_cc__Jan09-1846/")
cello("data/intestine_dev/cello_benchmark_Huycke_Jan08-1324/
")"
cello("data/intestine_dev/cello_benchmark_Huycke_Jan08-1324/")
cello("data/intestine_dev/cello_benchmark_Huycke_Jan08-1324/")
cello("data/intestine_dev/cello_benchmark_Huycke_Jan08-1324/")
library(VisCello)
cello("data/intestine_dev/cello_benchmark_Huycke_Jan08-1324/")
cello("data/intestine_dev/cello_benchmark_Huycke_Jan08-1324/")
library(VisCello)
cello("data/CE_CB/cello_benchmark_CBCE_Jan30-1028/")
names(clist$`All cells`@proj)
keep_proj = strsplit(c('Concord, Concord-decoder, Concord-decoder_UMAP, Concord-decoder_UMAP_3D, Concord_UMAP, Concord_UMAP_3D, Harmony, Harmony_UMAP, Liger, Liger_UMAP, Scanorama, Scanorama_UMAP, Seurat, Seurat_UMAP, Unintegrated, Unintegrated_UMAP, scVI, scVI_UMAP, Contrastive, Contrastive_UMAP'), ", ")
keep_proj
keep_proj = strsplit(c('Concord, Concord-decoder, Concord-decoder_UMAP, Concord-decoder_UMAP_3D, Concord_UMAP, Concord_UMAP_3D, Harmony, Harmony_UMAP, Liger, Liger_UMAP, Scanorama, Scanorama_UMAP, Seurat, Seurat_UMAP, Unintegrated, Unintegrated_UMAP, scVI, scVI_UMAP, Contrastive, Contrastive_UMAP'), ", ")[1]
keep_proj
eep_proj = strsplit(c('Concord, Concord-decoder, Concord-decoder_UMAP, Concord-decoder_UMAP_3D, Concord_UMAP, Concord_UMAP_3D, Harmony, Harmony_UMAP, Liger, Liger_UMAP, Scanorama, Scanorama_UMAP, Seurat, Seurat_UMAP, Unintegrated, Unintegrated_UMAP, scVI, scVI_UMAP, Contrastive, Contrastive_UMAP'), ", ")[[1]]
keep_proj = strsplit(c('Concord, Concord-decoder, Concord-decoder_UMAP, Concord-decoder_UMAP_3D, Concord_UMAP, Concord_UMAP_3D, Harmony, Harmony_UMAP, Liger, Liger_UMAP, Scanorama, Scanorama_UMAP, Seurat, Seurat_UMAP, Unintegrated, Unintegrated_UMAP, scVI, scVI_UMAP, Contrastive, Contrastive_UMAP'), ", ")[[1]]
keep_proj
clist$`All cells`@proj = clist$`All cells`@proj[keep_proj]
names(clist$`All cells`@proj)
saveRDS(clist, "data/CE_CB/cello_benchmark_CBCE_Jan30-1028/clist.rds")
cello(savePath)
cello("data/CE_CB/cello_benchmark_CBCE_Jan30-1028/")
library(VisCello)
cello("data/CE_CB/cello_benchmark_CBCE_Jan30-1028/")
cello("data/CE_CB/cello_benchmark_CBCE_Jan30-1028/")
cello("data/CE_CB/cello_benchmark_CBCE_Jan30-1028/")
pData(eset)$cell = NULL
saveRDS(eset, "data/CE_CB/cello_benchmark_CBCE_Jan30-1028/eset.rds")
cello("data/CE_CB/cello_benchmark_CBCE_Jan30-1028/")
cello("data/CE_CB/cello_benchmark_CBCE_Jan30-1028/")
library(VisCello)
cello("data/CE_CB/cello_benchmark_CBCE_Jan30-1028/")
cello("data/intestine_dev/cello_benchmark_Huycke_cc__Jan09-1846/")
cello("data/intestine_dev/cello_benchmark_Huycke_Jan08-1324//")
cello("data/intestine_dev/cello_benchmark_Huycke_Jan08-1324//")
library(VisCello)
cello("data/intestine_dev/cello_benchmark_Huycke_Jan08-1324//")
library(VisCello)
cello("data/intestine_dev/cello_benchmark_Huycke_Jan08-1324//")
cello("data/intestine_dev/cello_benchmark_Huycke_Jan08-1324//")
names(clist$`All cells`@proj)
clist$`All cells`@proj['Concord']
clist$`All cells`@proj['Concord_UMAP']
library(VisCello)
cello("../save/pbmc3k_Feb27/cello_pbmc3k_pbmc3k_Feb27-1554")
cello("./save/pbmc3k_Feb27/cello_pbmc3k_pbmc3k_Feb27-1554")
library(VisCello)
cello("./data/intestine_dev/cello_benchmark_Huycke_cc__Jan09-1846/")
cello("./data/intestine_dev/cello_benchmark_Huycke_Jan08-1324/")
library(VisCello)
cello("save/pbmc3k_Mar14/cello_pbmc3k_pbmc3k_Mar14-1320/")
install.packages("pak")
pak::pak("scverse/anndataR")
pak::pak("scverse/anndataR", dependencies = TRUE)
vignette("anndataR", package = "anndataR")
library(anndataR)
vignette("anndataR", package = "anndataR")
vignette("usage_h5ad", package = "anndataR")
?anndataR::from_Seurat()
dros_ec_all <- readRDS(paste0("./data/drosophila_bordercell/dros_ec_all.rds"))
ad1 = anndataR::from_Seurat(dros_ec_all)
library(Seurat)
library(dplyr)
library(patchwork)
# Individual merged files from different sequencing experiments
dros_ec_d1.data <- read.table("../data/drosophila_bordercell/out_gene_exon_tagged.dge.txt",
header=T,
row.names=1)
?write_h5ad
library(VisCello)
cello("./data/drosophila_bordercell/cello_concord_bordercell_Apr22-1311/")
library(VisCello)
cello("./data/drosophila_bordercell/cello_concord_bordercell_Apr22-1311/")
library(VisCello)
cello("./data/drosophila_bordercell/cello_concord_bordercell_Apr22-1311/")
cello("./data/drosophila_bordercell/cello_concord_bordercell_Apr22-1311/")
cello("./data/drosophila_bordercell/cello_concord_bordercell_Apr22-1311/")
cello("./data/drosophila_bordercell/cello_concord_bordercell_Apr22-1311/")
cello("./data/drosophila_bordercell/cello_concord_bordercell_Apr22-1311/")
cello("./data/drosophila_bordercell/cello_concord_bordercell_Apr22-1311/")
cello("./data/drosophila_bordercell/cello_concord_bordercell_Apr22-1311/")
cello("./data/drosophila_bordercell/cello_concord_bordercell_Apr22-1311/")
cello("./data/drosophila_bordercell/cello_concord_bordercell_Apr22-1311/")
cello("./data/drosophila_bordercell/cello_concord_bordercell_Apr22-1311/")
library(VisCello)
cello("./data/intestine_dev/cello_benchmark_Huycke_Jan08-1324/")
cello("./data/intestine_dev/cello_benchmark_Huycke_cc__Jan09-1846/")
cello("./data/intestine_dev/cello_benchmark_Huycke_Jan08-1324/")
eset$mac_subtype=NA
dep_idx = clist$Macrophage@idx
dep_clus = clist$Macrophage@pmeta$leiden_Concord_sub
eset$mac_subtype[dep_idx[dep_clus %in% c("15")]] = 'Monocyte'
eset$mac_subtype[dep_idx[dep_clus %in% c("13")]] = 'mo-DC/DC'
eset$mac_subtype[dep_idx[dep_clus %in% c('11', '14', '7')]] = 'Ccr2/Lyz2+ Macrophage'
eset$mac_subtype[dep_idx[dep_clus %in% c('0', '6', '2','10', '1')]] = 'Apol7c/Timd4/Mmp9+ gMac'
eset$mac_subtype[dep_idx[dep_clus %in% c('12', '4')]] = 'Differentiating monocyte'
eset$mac_subtype[dep_idx[dep_clus %in% c('9','5', '3', '8')]] = 'Lyve1+Mrc1+ M2â€like macrophage'
saveRDS(eset, "./data/intestine_dev/cello_benchmark_Huycke_Jan08-1324/eset.rds")
cello("./data/intestine_dev/cello_benchmark_Huycke_Jan08-1324")
cello("./data/intestine_dev/cello_benchmark_Huycke_Jan08-1324")
cello("./data/intestine_dev/cello_benchmark_Huycke_Jan08-1324")
remotes::install_github("satijalab/seurat-data", quiet = TRUE)
load(file = "../data/spatialDLPFC_Visium/sce_sub_for_vignette.Rdata")
load(file = "./data/spatialDLPFC_Visium/sce_sub_for_vignette.Rdata")
load(file = "./data/spatialDLPFC_Visium/Human_DLPFC_Visium_processedData_sce_scran_spatialLIBD.Rdata")
sce@metadata
colData(sce)
colnames(colData(sce))
colData(sce)
colData(sce)$Layer
table(colData(sce)$Layer)
table(colData(sce)$layer_guess_reordered)
sce@assays@data
sce@metadata
sce@int_elementMetadata
sce@int_colData
sce@int_colData$reducedDims
sce@int_metadata$scater
sce@colData
library(SpatialExperiment)
sce_to_spe <- function(sce = fetch_data("sce"), imageData = NULL) {
sce <- check_sce(sce)
# Load assays
assays_visium <- SummarizedExperiment::assays(sce)
# Load rowData
rowData_visium <- SummarizedExperiment::rowData(sce)
## Re-case tissue
if (is.factor(sce$tissue)) sce$tissue <- sce$tissue == "1"
# Load colData
cols_to_drop <-
c(
"tissue",
"row",
"col",
"imagerow",
"imagecol"
)
colData_visium <-
SummarizedExperiment::colData(sce)[, !colnames(SummarizedExperiment::colData(sce)) %in% c(cols_to_drop, "height", "width", "barcode"), drop = FALSE]
names(colData_visium)[names(colData_visium) == "sample_name"] <- "sample_id"
# Load spatialCoords
spatialCoords_visium <-
SummarizedExperiment::colData(sce)[, colnames(SummarizedExperiment::colData(sce)) %in% cols_to_drop, drop = FALSE]
names(spatialCoords_visium) <-
c(
"in_tissue",
"array_row",
"array_col",
"pxl_row_in_fullres",
"pxl_col_in_fullres"
)
## Use the official sample id name
colnames(colData_visium)[colnames(colData_visium) == "sample_name"] <- "sample_id"
colData_visium$sample_id <- as.character(colData_visium$sample_id)
# Load reducedDim
reducedDimNames_visium <-
SingleCellExperiment::reducedDims(sce)
# Load images from the web for our data
if (is.null(imageData)) {
sample_id <- unique(colData_visium$sample_id)
url_images <-
paste0(
"https://spatial-dlpfc.s3.us-east-2.amazonaws.com/images/",
sample_id,
"_tissue_lowres_image.png"
)
# Load scaleFactors
url_scaleFactors <- paste0(
"https://raw.githubusercontent.com/LieberInstitute/",
"HumanPilot/master/10X/",
sample_id,
"/scalefactors_json.json"
)
names(url_scaleFactors) <- sample_id
scaleFactors_visium <-
lapply(url_scaleFactors, jsonlite::read_json)
## Create a list of images
spatial_img_list <- mapply(function(url) {
SpatialExperiment::SpatialImage(
url
)
}, url_images)
img_dat <- DataFrame(
sample_id = as.character(sample_id),
image_id = rep("lowres", length(sample_id)),
data = I(spatial_img_list),
scaleFactor = vapply(
scaleFactors_visium,
"[[",
numeric(1),
"tissue_lowres_scalef",
USE.NAMES = FALSE
)
)
imageData <- img_dat
## Fix things we had done that are not default:
# Scaling for lowres image: https://github.com/LieberInstitute/HumanPilot/blob/master/Analysis/Layer_Notebook.R#L118-L119
spatialCoords_visium$pxl_col_in_fullres <- spatialCoords_visium$pxl_col_in_fullres / img_dat$scaleFactor[match(colData_visium$sample_id, img_dat$sample_id)]
spatialCoords_visium$pxl_row_in_fullres <- spatialCoords_visium$pxl_row_in_fullres / img_dat$scaleFactor[match(colData_visium$sample_id, img_dat$sample_id)]
## Names of the columns is flipped at https://github.com/LieberInstitute/HumanPilot/blob/master/Analysis/Layer_Notebook.R#L116 compared to what
## SpatialExperiment does at https://github.com/drighelli/SpatialExperiment/blob/bf1b18b559ea2785d52db4e39a85f1d584aede45/R/read10xVisium.R#L170
# tmp <- spatialCoords_visium$pxl_row_in_fullres
# spatialCoords_visium$pxl_row_in_fullres <- spatialCoords_visium$pxl_col_in_fullres
# spatialCoords_visium$pxl_col_in_fullres <- tmp
## The above is no longer necessary thanks to https://github.com/drighelli/SpatialExperiment/commit/6710fe8b0a7919191ecce989bb6831647385ef5f
}
# ## Create object manually
# spe <- new("SpatialExperiment", SingleCellExperiment::SingleCellExperiment(
#     rowData = rowData_visium,
#     colData = colData_visium,
#     assays = assays_visium,
#     reducedDims = reducedDimNames_visium
# ))
#
# ## Add missing spatial info
# colData(spe) <- spatialCoords_visium
# SpatialExperiment::spatialCoordsNames(spe) <- c("pxl_col_in_fullres", "pxl_row_in_fullres")
# SpatialExperiment::imgData(spe) <- imageData
#
## This works now in SpatialExperiment version 1.1.701, so we no longer
## need the manual code from above
## The following code ultimately fails due to the current lack of support
## for multiple `sample_id`s, as in
## https://github.com/drighelli/SpatialExperiment/blob/a9e54fbd5af7fe676f8a5b29e4cfe113402070d4/R/SpatialExperiment.R#L143-L144
## or in
## https://github.com/drighelli/SpatialExperiment/blob/a9e54fbd5af7fe676f8a5b29e4cfe113402070d4/R/SpatialExperiment.R#L164
spe <- SpatialExperiment::SpatialExperiment(
rowData = rowData_visium,
colData = cbind(colData_visium, spatialCoords_visium),
assays = assays_visium,
reducedDims = reducedDimNames_visium,
sample_id = NULL,
spatialCoordsNames = c("pxl_col_in_fullres", "pxl_row_in_fullres"),
scaleFactors = img_dat$scaleFactor,
imgData = img_dat,
imageSources = url_images,
loadImage = FALSE
)
return(spe)
}
spe = sce_to_spe(sce_sub)
sce_to_spe <- function(sce = fetch_data("sce"), imageData = NULL) {
# Load assays
assays_visium <- SummarizedExperiment::assays(sce)
# Load rowData
rowData_visium <- SummarizedExperiment::rowData(sce)
## Re-case tissue
if (is.factor(sce$tissue)) sce$tissue <- sce$tissue == "1"
# Load colData
cols_to_drop <-
c(
"tissue",
"row",
"col",
"imagerow",
"imagecol"
)
colData_visium <-
SummarizedExperiment::colData(sce)[, !colnames(SummarizedExperiment::colData(sce)) %in% c(cols_to_drop, "height", "width", "barcode"), drop = FALSE]
names(colData_visium)[names(colData_visium) == "sample_name"] <- "sample_id"
# Load spatialCoords
spatialCoords_visium <-
SummarizedExperiment::colData(sce)[, colnames(SummarizedExperiment::colData(sce)) %in% cols_to_drop, drop = FALSE]
names(spatialCoords_visium) <-
c(
"in_tissue",
"array_row",
"array_col",
"pxl_row_in_fullres",
"pxl_col_in_fullres"
)
## Use the official sample id name
colnames(colData_visium)[colnames(colData_visium) == "sample_name"] <- "sample_id"
colData_visium$sample_id <- as.character(colData_visium$sample_id)
# Load reducedDim
reducedDimNames_visium <-
SingleCellExperiment::reducedDims(sce)
# Load images from the web for our data
if (is.null(imageData)) {
sample_id <- unique(colData_visium$sample_id)
url_images <-
paste0(
"https://spatial-dlpfc.s3.us-east-2.amazonaws.com/images/",
sample_id,
"_tissue_lowres_image.png"
)
# Load scaleFactors
url_scaleFactors <- paste0(
"https://raw.githubusercontent.com/LieberInstitute/",
"HumanPilot/master/10X/",
sample_id,
"/scalefactors_json.json"
)
names(url_scaleFactors) <- sample_id
scaleFactors_visium <-
lapply(url_scaleFactors, jsonlite::read_json)
## Create a list of images
spatial_img_list <- mapply(function(url) {
SpatialExperiment::SpatialImage(
url
)
}, url_images)
img_dat <- DataFrame(
sample_id = as.character(sample_id),
image_id = rep("lowres", length(sample_id)),
data = I(spatial_img_list),
scaleFactor = vapply(
scaleFactors_visium,
"[[",
numeric(1),
"tissue_lowres_scalef",
USE.NAMES = FALSE
)
)
imageData <- img_dat
## Fix things we had done that are not default:
# Scaling for lowres image: https://github.com/LieberInstitute/HumanPilot/blob/master/Analysis/Layer_Notebook.R#L118-L119
spatialCoords_visium$pxl_col_in_fullres <- spatialCoords_visium$pxl_col_in_fullres / img_dat$scaleFactor[match(colData_visium$sample_id, img_dat$sample_id)]
spatialCoords_visium$pxl_row_in_fullres <- spatialCoords_visium$pxl_row_in_fullres / img_dat$scaleFactor[match(colData_visium$sample_id, img_dat$sample_id)]
## Names of the columns is flipped at https://github.com/LieberInstitute/HumanPilot/blob/master/Analysis/Layer_Notebook.R#L116 compared to what
## SpatialExperiment does at https://github.com/drighelli/SpatialExperiment/blob/bf1b18b559ea2785d52db4e39a85f1d584aede45/R/read10xVisium.R#L170
# tmp <- spatialCoords_visium$pxl_row_in_fullres
# spatialCoords_visium$pxl_row_in_fullres <- spatialCoords_visium$pxl_col_in_fullres
# spatialCoords_visium$pxl_col_in_fullres <- tmp
## The above is no longer necessary thanks to https://github.com/drighelli/SpatialExperiment/commit/6710fe8b0a7919191ecce989bb6831647385ef5f
}
# ## Create object manually
# spe <- new("SpatialExperiment", SingleCellExperiment::SingleCellExperiment(
#     rowData = rowData_visium,
#     colData = colData_visium,
#     assays = assays_visium,
#     reducedDims = reducedDimNames_visium
# ))
#
# ## Add missing spatial info
# colData(spe) <- spatialCoords_visium
# SpatialExperiment::spatialCoordsNames(spe) <- c("pxl_col_in_fullres", "pxl_row_in_fullres")
# SpatialExperiment::imgData(spe) <- imageData
#
## This works now in SpatialExperiment version 1.1.701, so we no longer
## need the manual code from above
## The following code ultimately fails due to the current lack of support
## for multiple `sample_id`s, as in
## https://github.com/drighelli/SpatialExperiment/blob/a9e54fbd5af7fe676f8a5b29e4cfe113402070d4/R/SpatialExperiment.R#L143-L144
## or in
## https://github.com/drighelli/SpatialExperiment/blob/a9e54fbd5af7fe676f8a5b29e4cfe113402070d4/R/SpatialExperiment.R#L164
spe <- SpatialExperiment::SpatialExperiment(
rowData = rowData_visium,
colData = cbind(colData_visium, spatialCoords_visium),
assays = assays_visium,
reducedDims = reducedDimNames_visium,
sample_id = NULL,
spatialCoordsNames = c("pxl_col_in_fullres", "pxl_row_in_fullres"),
scaleFactors = img_dat$scaleFactor,
imgData = img_dat,
imageSources = url_images,
loadImage = FALSE
)
return(spe)
}
spe = sce_to_spe(sce_sub)
if (interactive()) {
run_app(
spe = spe
)
}
library(shiny)
if (interactive()) {
run_app(
spe = spe
)
}
vis_clus(
spe = spe,
clustervar = "layer_guess_reordered",
sampleid = "151673",
colors = libd_layer_colors,
... = " LIBD Layers"
)
library(spatialLIBD)
vis_clus(
spe = spe,
clustervar = "layer_guess_reordered",
sampleid = "151673",
colors = libd_layer_colors,
... = " LIBD Layers"
)
if (interactive()) {
run_app(
spe = spe
)
}
if (!exists("sce_layer")) sce_layer <- fetch_data(type = "sce_layer", eh = ehub)
ehub <- ExperimentHub::ExperimentHub()
if (!exists("sce_layer")) sce_layer <- fetch_data(type = "sce_layer", eh = ehub)
load("./data/Human_DLPFC_Visium_processedData_sce_scran_sce_layer_spatialLIBD.Rdata")
load("./data/spatialDLPFC_Visium//Human_DLPFC_Visium_processedData_sce_scran_sce_layer_spatialLIBD.Rdata")
modeling_results <- fetch_data("modeling_results", eh = ehub)
load("./data/spatialDLPFC_Visium/Human_DLPFC_Visium_modeling_results.Rdata")
if (interactive()) {
run_app(
spe = spe,
sce_layer = sce_layer,
modeling_results = modeling_results,
sig_genes = sig_genes
)
}
if (interactive()) {
run_app(
spe = spe,
sce_layer = sce_layer,
modeling_results = modeling_results,
)
}
vis_clus(
spe = spe,
clustervar = "layer_guess_reordered",
sampleid = "151673",
colors = libd_layer_colors,
... = " LIBD Layers"
)
vis_clus(
spe = spe,
clustervar = "layer_guess_reordered",
sampleid = "151673",
colors = libd_layer_colors,
... = " LIBD Layers",
spatial = FALSE
)
library(Vis)
library(VisCello)
cello("./data/janesick_nature_comms_2023/cello_visium_janesick_nc_2023_dev_Jun03-1817/")
cello("./data/janesick_nature_comms_2023/cello_xenium_janesick_nc_2023_dev_Jun03-1817/
")"
cello("./data/janesick_nature_comms_2023/cello_xenium_janesick_nc_2023_dev_Jun03-1817/")
cello("./data/intestine_dev/cello_benchmark_Huycke_Jan08-1324/")
cello("./data/janesick_nature_comms_2023/cello_xenium_janesick_nc_2023_dev_Jun03-1817/")
cello("./data/janesick_nature_comms_2023/cello_xenium_janesick_nc_2023_dev_Jun03-1817/")
cello("./data/intestine_dev/cello_benchmark_Huycke_Jan08-1324/")
cello("./data/janesick_nature_comms_2023/cello_xenium_janesick_nc_2023_dev_Jun03-1817/")
cello("./data/janesick_nature_comms_2023/cello_xenium_janesick_nc_2023_dev_Jun03-1817/")
library(VisCello)
cello("./data/janesick_nature_comms_2023/cello_xenium_janesick_nc_2023_dev_Jun03-1817/")
cello("./data/janesick_nature_comms_2023/cello_xenium_janesick_nc_2023_dev_Jun05-1233/")
cello("./data/janesick_nature_comms_2023/cello_xenium_janesick_nc_2023_dev_Jun05-1233/")
clist$xenium_rep1@idx
cello("./data/janesick_nature_comms_2023/cello_xenium_janesick_nc_2023_dev_Jun05-1233/")
library(VisCello)
cello("./data/janesick_nature_comms_2023/cello_scRNA_scRNAxenium_janesick_nc_2023_scRNAxenium_Jun06-1232")
